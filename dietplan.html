<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Diet Plan</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      margin: 0;
      padding: 20px;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 5px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 20px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 20px;
    }

    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.05);
      margin-bottom: 20px;
    }

    .bmi {
      text-align: center;
    }

    .bmi h2 {
      margin: 10px 0;
      font-size: 30px;
      color: #d9534f;
    }

    .summary {
      display: flex;
      justify-content: space-between;
      text-align: center;
      margin: 15px 0;
    }

    .summary div {
      flex: 1;
    }

    .meal {
      margin-bottom: 20px;
    }

    .meal h3 {
      margin-bottom: 5px;
    }

    .foods {
      margin: 10px 0;
      padding-left: 20px;
    }

    .macros {
      font-size: 14px;
      color: #444;
      display: flex;
      justify-content: space-between;
      border-top: 1px solid #eee;
      padding-top: 5px;
    }

    .calories {
      float: right;
      font-size: 14px;
      color: #333;
      font-weight: bold;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .btn {
      padding: 8px 16px;
      background: black;
      color: white;
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
    }

  </style>
</head>
<body>

  <div class="top-bar">
    <h1>Your Diet Plan</h1>
    <a href="mainpage.html" class="btn">Start Over</a>
  </div>

  <p class="subtitle">Personalized for <span id="gender"></span>, <span id="age"></span> years old, <span id="goal"></span> goal</p>

  <div class="grid">
    <!-- BMI Section -->
    <div class="card bmi">
      <h3>BMI Calculator</h3>
      <p>Body Mass Index assessment</p>
      <h2 id="bmi-value">--</h2>
      <p id="bmi-status">--</p>
      <small>
        <b>BMI Categories:</b><br>
        Underweight: &lt; 18.5 <br>
        Normal: 18.5 - 24.9 <br>
        Overweight: 25 - 29.9 <br>
        Obese: ≥ 30
      </small>
    </div>

    <!-- Diet Plan Section -->
    <div>
      <div class="card">
        <h3>Your Personalized Diet Plan</h3>
        <p id="plan-description"></p>
        <div class="summary">
          <div><strong id="calories">--</strong><br>Calories</div>
          <div><strong id="protein">--</strong><br>Protein</div>
          <div><strong id="carbs">--</strong><br>Carbs</div>
          <div><strong id="fat">--</strong><br>Fat</div>
        </div>
      </div>

      <div id="meals"></div>
    </div>
  </div>

  <script>
    // Get URL Params
    const params = new URLSearchParams(window.location.search);
    const age = params.get("age");
    const weight = params.get("weight");
    const height = params.get("height");
    const gender = params.get("gender");
    const goal = params.get("goal");
    const activity = params.get("activity");

    document.getElementById("age").textContent = age;
    document.getElementById("gender").textContent = gender.toLowerCase();
    document.getElementById("goal").textContent = goal.toLowerCase();

    // BMI calculation
    const hMeters = height / 100;
    const bmi = (weight / (hMeters * hMeters)).toFixed(1);
    document.getElementById("bmi-value").textContent = bmi;

    let status = "";
    if (bmi < 18.5) status = "Underweight";
    else if (bmi < 25) status = "Normal";
    else if (bmi < 30) status = "Overweight";
    else status = "Obese";

    document.getElementById("bmi-status").textContent = status;

    // Example calorie adjustment by goal
    let calories = weight * 22;
    if (goal === "Weight Loss") calories -= 500;
    else if (goal === "Muscle Gain") calories += 500;

    // Adjust by activity
    const activityMultiplier = {
      "Sedentary": 1.2,
      "Light": 1.375,
      "Moderate": 1.55,
      "Active": 1.725,
      "Very Active": 1.9
    };
    calories = Math.round(calories * (activityMultiplier[activity] || 1.2));

    // Macronutrients
    const protein = Math.round(weight * 2);
    const fat = Math.round(weight * 0.8);
    const carbs = Math.round((calories - (protein*4 + fat*9)) / 4);

    document.getElementById("calories").textContent = calories;
    document.getElementById("protein").textContent = protein + "g";
    document.getElementById("carbs").textContent = carbs + "g";
    document.getElementById("fat").textContent = fat + "g";

    document.getElementById("plan-description").textContent =
      `Based on your ${goal.toLowerCase()} goal and ${activity.toLowerCase()} lifestyle`;

    // Example meal plan
    const meals = [
      {
        name: "Breakfast",
        foods: ["Oatmeal with berries and nuts", "Greek yogurt", "Green tea"],
        protein: 35, carbs: 88, fat: 23, cal: 704
      },
      {
        name: "Lunch",
        foods: ["Grilled chicken breast", "Quinoa salad with vegetables", "Avocado", "Water with lemon"],
        protein: 74, carbs: 99, fat: 33, cal: 986
      },
      {
        name: "Dinner",
        foods: ["Baked salmon", "Sweet potato", "Steamed broccoli", "Mixed green salad"],
        protein: 53, carbs: 95, fat: 28, cal: 845
      },
      {
        name: "Snack",
        foods: ["Apple with almond butter", "Herbal tea"],
        protein: 11, carbs: 42, fat: 8, cal: 282
      }
    ];

    const mealContainer = document.getElementById("meals");
    meals.forEach(m => {
      mealContainer.innerHTML += `
        <div class="card meal">
          <h3>${m.name} <span class="calories">${m.cal} cal</span></h3>
          <div class="foods">${m.foods.map(f => "• " + f).join("<br>")}</div>
          <div class="macros">
            <span>Protein: ${m.protein}g</span>
            <span>Carbs: ${m.carbs}g</span>
            <span>Fat: ${m.fat}g</span>
          </div>
        </div>`;
    });
  </script>

</body>
</html>
